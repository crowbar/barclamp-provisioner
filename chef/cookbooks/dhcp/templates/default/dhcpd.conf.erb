# File managed by chef

omapi-port 9991;
        key omapi_key {
        algorithm HMAC-MD5;
        secret "<%= %x{cat /etc/dhcp3/omapi.key}.chomp %>";
};
omapi-key omapi_key;



<% if not @options.empty? -%>
  <% @options.each do |option| -%>
<%= option %>;
  <% end -%>
<% end -%>

# Need to set a few iPXE variables
option space ipxe;
option ipxe-encap-opts code 175 = encapsulate ipxe;
option ipxe.no-pxedhcp code 176 = unsigned integer 8;
option ipxe.no-pxedhcp 1;

next-server <%=@provisioner_ip%>;
if exists user-class and option user-class = "iPXE" {
   filename "http://<%=@provisioner_ip%>:<%=@provisioner_port%>/boot.ipxe";
} else {
  filename "ipxe.kpxe";
}


# Use this to send dhcp log messages to a different log file (you also
# have to hack syslog.conf to complete the redirection).
log-facility local7;

include "/etc/dhcp3/groups.d/group_list.conf";
include "/etc/dhcp3/subnets.d/subnet_list.conf";
include "/etc/dhcp3/hosts.d/host_list.conf";

